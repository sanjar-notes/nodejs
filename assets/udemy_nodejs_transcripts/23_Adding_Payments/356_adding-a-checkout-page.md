## 356. Adding a Checkout Page

<strong><em>no description</em></strong>

To add payment to our application, let's work on that checkout.ejs file with
which we never work thus far. 

I want to go there before I actually place an order when I click on order now in
my cart, so I'll go to this page first. 

For that, I'll copy the content of cart.ejs add it in checkout.ejs to make sure
that I have my default head. 

I'll get rid of that stylesheet though, I don't need it here, I want to include
the navigation,  the main content will be totally different though, I will keep
my body however, so or my end here. 

So with that, I have everything set up to have a basic checkout page, now let's
first of all make sure we reach that before we start adding stripe. 

For that we need a new route of course in a shop.js file, here we have our
create order route and in the end what I need is a new route, a get route which
we can name checkout and there, I want to be authenticated because we can only
buy something if we are logged in let's say and then I'll use my shop controller
and there, get checkout which is an action I still have to create. 

And in that get checkout page then, we'll have the possibility to create an
order and so on. 

So for now, let's just add this and let's work on our controller then, on our
shop controller and there I need a get checkout method. 

So maybe here before post order because logically, it comes prior to that, I'll
have get checkout with request response and next and in there, I want to render
my checkout page. 

So we can of course grab one of our other render functions here, render that,
here I will render shop/checkout, the path can be checkout, it doesn't really
matter, we don't have a naviagtion item we want to highlight, here we can
checkout as a text and of course we need some data for the checkout. 

Now what do I want to return here? 

Well in the end, I will need the same data as I have in my cart, so I need my
products here which I do have in the cart, so I can actually copy that entire
code from get cart I guess and add this here and now just make sure we use shop
checkout, path checkout and here, checkout but besides that I also need to
calculate the total let's say. 

So total sum or whatever you want to name it and that total sum of course can be
retrieved from our product data because in the cart or in the products here we
have in the cart, you have to keep in mind that products is in an array of
products where we have the quantity and then a product ID field with detail data
about the products because we populate this product ID field with the detailed
product data. 

So therefore, the total sum can be generated by looping through all products, so
here I can do products forEach and create a new variable, total which is zero
initially and then there, total is equal plus equal this shortcut to add
something to the existing total, so total plus the product and then there is a
quantity field times the product product ID price and then it's this total which
I pass to my view. 

So that's all the data I should need in checkout view. 

So now back in my checkout.ejs file, now I can indeed grab that unordered list
for rendering a list of items like this, I'll go through all my products. 

I'll remove the delete button though, it's too late at this point let's say, we
can of course always cancel the checkout process if we want to though, actually
I'll delete this entire form therefore, this is my unordered list and below
that, we can add a div with a h2 tag of total and then here I output total sum. 

Now let's have a look at that and to have a look, I need to make sure that on
cart.ejs when you click order now, I don't submit this form here, so I will
actually comment this out, we don't need that anymore but instead I want to have
a normal anchor tag here where I say order now where I simply point at
/checkout, so this new route we added and I'll just give this a class of button
to look a bit like a button. 

With all that added, let's go back to our page, let's go to products here maybe,
add this to the cart and click order now and this is now my, well a page here. 

Now it's not looking super beautiful I'd say, I need to include that cart.css
file again because since I'm reusing the rest of the code here and we could
create our own stylesheet but I want to keep this relatively short, since I'm
using all that, I of course also want to use the same styles. 

So now if I reload this checkout page here, it's looking ok, the total could be
placed in the middle maybe, we can do that by giving this div a class of
centered which is a utility class I added earlier in the course and now we have
this checkout page. 

Again we can always work on the visuals but it's not so much about the visuals
here. 

So now we have this total and now I want to add stripe and for that, let's first
of all set up an account with them. 

---