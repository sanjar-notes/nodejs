WEBVTT

00:02.220 --> 00:05.210
So let's clear the cart after storing an order

00:05.550 --> 00:11.250
and for that, here once I'm done with saving the order, I want to clear the cart

00:11.340 --> 00:16.310
and one way to do that would be to go to the user model and add a new method there.

00:16.650 --> 00:23.450
We can go to the user schema, to the methods key and then add a clear cart method,

00:23.530 --> 00:26.770
so simply a function we can call to clear the entire cart

00:26.970 --> 00:28.340
and how would we do that?

00:28.560 --> 00:37.020
Well we would simply set this cart equal to an object where we have an empty array of items and then

00:37.020 --> 00:45.390
we just return this, whoops, return this save and that should be it. That updates the carts to have no

00:45.390 --> 00:51.000
items in it anymore and we then save this and therefore we update this. With this, let's go back to the

00:51.000 --> 00:52.160
shop controller

00:52.290 --> 00:58.930
and here once we know that the order was placed, let's simply call request user clear cart,

00:58.950 --> 01:08.400
this method we just added and then I will return that and move my redirection into a new then block

01:08.850 --> 01:15.400
after the previous one which will only execute once the cart was cleared.

01:15.410 --> 01:22.300
So now with that, let's save that, let's now also go to products and maybe add another product to our cart.

01:22.610 --> 01:23.750
Let's order that cart

01:23.750 --> 01:28.400
now, let's click on cart again, no products in cart, this is looking great.

01:28.550 --> 01:34.670
Let's quickly check our orders in compass and this new order should now have two products, that is looking

01:34.670 --> 01:35.160
good,

01:35.300 --> 01:41.050
one with quantity two, that was our nice book and one with quantity one, that was the second product

01:41.270 --> 01:45.240
and in the users, the cart is empty.

01:45.290 --> 01:50.960
So now we got an elegant way of managing orders and the cart through mongoose.

01:51.090 --> 01:57.030
However let's of course also add the functionality to get the cart in the next lecture.
